<!DOCTYPE html>
<html>

<head>
  <base target="_top">
  <?!= include('CSS');?>
</head>

<body class="my-0 vh-100 row justify-content-top align-items-top">
  <div class="container mt-0">
    <nav class="navbar navbar-dark bg-primary">
      <div>
        <h3 class="text-white">&nbsp;&nbsp;&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"
            fill="currentColor" class="bi bi-bounding-box-circles" viewBox="0 0 16 16">
            <path
              d="M2 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zM0 2a2 2 0 0 1 3.937-.5h8.126A2 2 0 1 1 14.5 3.937v8.126a2 2 0 1 1-2.437 2.437H3.937A2 2 0 1 1 1.5 12.063V3.937A2 2 0 0 1 0 2zm2.5 1.937v8.126c.703.18 1.256.734 1.437 1.437h8.126a2.004 2.004 0 0 1 1.437-1.437V3.937A2.004 2.004 0 0 1 12.063 2.5H3.937A2.004 2.004 0 0 1 2.5 3.937zM14 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zM2 13a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm12 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2z" />
          </svg>&nbsp;&nbsp;&nbsp;OfficeApp</h3>
      </div>
      <h3 class="text-white align-rigth">UNIVERSIDAD UMARIANA&nbsp;&nbsp;&nbsp;</h3>
    </nav>
    <nav class="navbar navbar-expand-lg" style="background-color: #e3f2fd;">
      <div class="collapse navbar-collapse" id="navbarColor03">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" href="<?= pubUrl ?>?p=1"><svg xmlns="http://www.w3.org/2000/svg" width="24"
                height="24" fill="currentColor" class="bi bi-journal-plus" viewBox="0 0 16 16">
                <path fill-rule="evenodd"
                  d="M8 5.5a.5.5 0 0 1 .5.5v1.5H10a.5.5 0 0 1 0 1H8.5V10a.5.5 0 0 1-1 0V8.5H6a.5.5 0 0 1 0-1h1.5V6a.5.5 0 0 1 .5-.5z" />
                <path
                  d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z" />
                <path
                  d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z" />
              </svg> Nuevo Retiro</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="<?= pubUrl ?>?p=3"><svg xmlns="http://www.w3.org/2000/svg" width="24"
                height="24" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                <path
                  d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
              </svg> Buscar Retiro</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                fill="currentColor" class="bi bi-bar-chart-line" viewBox="0 0 16 16">
                <path
                  d="M11 2a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v12h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1v-3a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3h1V7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7h1V2zm1 12h2V2h-2v12zm-3 0V7H7v7h2zm-5 0v-3H2v3h2z" />
              </svg> DashBoard</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="<?= pubUrl ?>?p=12"><svg xmlns="http://www.w3.org/2000/svg" width="16"
                height="16" fill="currentColor" class="bi bi-telephone-plus-fill" viewBox="0 0 16 16">
                <path fill-rule="evenodd"
                  d="M1.885.511a1.745 1.745 0 0 1 2.61.163L6.29 2.98c.329.423.445.974.315 1.494l-.547 2.19a.678.678 0 0 0 .178.643l2.457 2.457a.678.678 0 0 0 .644.178l2.189-.547a1.745 1.745 0 0 1 1.494.315l2.306 1.794c.829.645.905 1.87.163 2.611l-1.034 1.034c-.74.74-1.846 1.065-2.877.702a18.634 18.634 0 0 1-7.01-4.42 18.634 18.634 0 0 1-4.42-7.009c-.362-1.03-.037-2.137.703-2.877L1.885.511zM12.5 1a.5.5 0 0 1 .5.5V3h1.5a.5.5 0 0 1 0 1H13v1.5a.5.5 0 0 1-1 0V4h-1.5a.5.5 0 0 1 0-1H12V1.5a.5.5 0 0 1 .5-.5z" />
              </svg> Guía Telefónica</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active"
              href="<?= pubUrl ?>?p=13"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAABo0lEQVRIic3VzWoUQRAH8J8reBMUMevBj4cwkCiC0WfwlJO3gA+xevUWiAriwYNPIOIKihcFP5K9CJ4Dkt2LoJDkuMp4mBps2+ldRwJaUMx09b8+urqriv+MloMPhHroJ+vzmAYvJvJ+YDvTPVQYYoBxrKv4H8Rehbt/4+B9YnAev+tq/Az2OjjYw+l5RnvqtIyw38F46mSEOwp3cqqg+Bz3sZPIvuIFPhR0FkqnGGbA9ZAfw0l8Cfl1HMbrFuPDWWm6mYEv4yLexv5jbEYKbhWiH5SML2KSgVcj8rXAbOECLuFbwcHYr3VCKE1bwNu4gnNxukc4jk8F4w1PsZQ6WC44yCM7gYeRhrNYiSDmOmhSNG4BV/iOq4HZDPwNdZtYzbA76rbSSvklN3w79l/hSfy/iZOvZNjiJfP7M63UxXME1/ysgT6Ohs5Ghn9aMl4qtI/qovqcyCZ4gJcFndZC66nLfKRbH2p4N3Q3cGhWmqgbVxcnu/6g2eV0IO161iQaxbcZOJNkrxk4z2K91TX6xnl6WenITN/5wpxAO9GSlgr9p/QDn0PzvQrrNU0AAAAASUVORK5CYII="> Tarifas Matrícula 1-2023</a>
          </li>
        </ul>
        <div class="vr"></div>
        <div class="d-flex">&nbsp;&nbsp;
          <a class="navbar-brand" href="<?= pubUrl ?>"><strong>Cerrar Sesión</strong></a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor03" aria-controls="navbarColor03" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
        </div>
      </div>
    </nav>
    <div class="container mt-5">
      <h5 class="text-primary">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-people"
          viewBox="0 0 16 16">
          <path
            d="M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0zM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816zM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275zM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4z" />
        </svg>
        Buscar estudiantes por solicitud de Retiro
      </h5>
      <br/>
      <div class="row d-flex justify-content-center mb-3">
        <div class="col">
          <input type="text" class="form-control" id="txt_codigoEstudiantil" placeholder="Ingrese el codigo a buscar" aria-label="Código Estudiantil">
        </div>
        <div class="col-1">
          <button type="button" class="btn btn-primary" onclick="buscarRegistro()"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
  <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
</svg> Buscar</button>
        </div>
        <br>
      </div>
      <div class="container text-center">
        <div class="row">
          <p class="text-start"><strong>Convenciones:</strong></p>
          <div class="col">
            <div class="badge bg-secondary text-wrap" style="width: 6rem;"><strong>PA</strong>
              <hr class="my-1"> Programas Académicos
            </div>
          </div>
          <div class="col">
            <div class="badge bg-secondary text-wrap" style="width: 7rem;"><strong>CC</strong>
              <hr class="my-1"> Crédito.Cartera
            </div>
          </div>
          <div class="col">
            <div class="badge bg-secondary text-wrap" style="width: 7rem;"><strong>AI</strong>
              <hr class="my-1"> Acomp.Integral
            </div>
          </div>
          <div class="col">
            <div class="badge bg-secondary text-wrap" style="width: 6rem;"><strong>VA</strong>
              <hr class="my-1"> Vic.Académica
            </div>
          </div>
          <div class="col">
            <div class="badge bg-secondary text-wrap" style="width: 6rem;"><strong>VF</strong>
              <hr class="my-1"> Vic.Adm.Fin.
            </div>
          </div>
          <div class="col">
            <div class="badge bg-secondary text-wrap" style="width: 10rem;"><strong>RCA</strong>
              <hr class="my-1"> Registro.Control.Acad.
            </div>
          </div>
        </div>
      </div>
      <hr class="my-1">
      <table id="manteniemientosTable" class="table table-striped">
        <thead>
          <tr>
            <th>Id</th>
            <th>Fecha Solicitud Retiro</th>
            <th>Identificación</th>
            <th>Código Estudiantil</th>
            <th>Apellidos - Nombres</th>
            <th>Programa Académico</th>
            <th>Opciones</th>
          </tr>
        </thead>
        <tbody id="manteniemientosTableBody">
          <!-- aqui se insertara toda la informacion que la traigamos de los datos de busqueda-->
        </tbody>
      </table>
    </div>

    <template id="manteniemientosRow">
      <tr>
        <td class="mantenimientosId" rowspan="2" align="center" valign="middle"></td>
        <td class="mantenimientosFecha"></td>
        <td class="mantenimientosIdentifacion"></td>
        <td class="mantenimientosCodigo"></td>
        <td class="mantenimientosApellidos"></td>
        <td class="mantenimientosPrograma" rowspan="2" valign="middle"></td>
        <td class="mantenimientosBotones" rowspan="2" valign="middle">
          <!-- <a class="edit-href"
          title="Verificar Retiro"><button type="button" class="btn btn-primary editar-button">Revisar Retiro</button></a>-->
          <a class="adjunto-href" target="_blank" title="Documento soporte del retiro"><button type="button" class="btn btn-warning"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-filetype-doc" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M14 4.5V14a2 2 0 0 1-2 2v-1a1 1 0 0 0 1-1V4.5h-2A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v9H2V2a2 2 0 0 1 2-2h5.5L14 4.5Zm-7.839 9.166v.522c0 .256-.039.47-.117.641a.861.861 0 0 1-.322.387.877.877 0 0 1-.469.126.883.883 0 0 1-.471-.126.868.868 0 0 1-.32-.386 1.55 1.55 0 0 1-.117-.642v-.522c0-.257.04-.471.117-.641a.868.868 0 0 1 .32-.387.868.868 0 0 1 .471-.129c.176 0 .332.043.469.13a.861.861 0 0 1 .322.386c.078.17.117.384.117.641Zm.803.519v-.513c0-.377-.068-.7-.205-.972a1.46 1.46 0 0 0-.589-.63c-.254-.147-.56-.22-.917-.22-.355 0-.662.073-.92.22a1.441 1.441 0 0 0-.589.627c-.136.271-.205.596-.205.975v.513c0 .375.069.7.205.973.137.271.333.48.59.627.257.144.564.216.92.216.357 0 .662-.072.916-.216.256-.147.452-.356.59-.627.136-.274.204-.598.204-.973ZM0 11.926v4h1.459c.402 0 .735-.08.999-.238a1.45 1.45 0 0 0 .595-.689c.13-.3.196-.662.196-1.084 0-.42-.065-.778-.196-1.075a1.426 1.426 0 0 0-.59-.68c-.263-.156-.598-.234-1.004-.234H0Zm.791.645h.563c.248 0 .45.05.609.152a.89.89 0 0 1 .354.454c.079.201.118.452.118.753a2.3 2.3 0 0 1-.068.592 1.141 1.141 0 0 1-.196.422.8.8 0 0 1-.334.252 1.298 1.298 0 0 1-.483.082H.79V12.57Zm7.422.483a1.732 1.732 0 0 0-.103.633v.495c0 .246.034.455.103.627a.834.834 0 0 0 .298.393.845.845 0 0 0 .478.131.868.868 0 0 0 .401-.088.699.699 0 0 0 .273-.248.8.8 0 0 0 .117-.364h.765v.076a1.268 1.268 0 0 1-.226.674c-.137.194-.32.345-.55.454a1.81 1.81 0 0 1-.786.164c-.36 0-.664-.072-.914-.216a1.424 1.424 0 0 1-.571-.627c-.13-.272-.194-.597-.194-.976v-.498c0-.379.066-.705.197-.978.13-.274.321-.485.571-.633.252-.149.556-.223.911-.223.219 0 .421.032.607.097.187.062.35.153.489.272a1.326 1.326 0 0 1 .466.964v.073H9.78a.85.85 0 0 0-.12-.38.7.7 0 0 0-.273-.261.802.802 0 0 0-.398-.097.814.814 0 0 0-.475.138.868.868 0 0 0-.301.398Z"/>
</svg></button></a>
          <a class="final-href" target="_blank" title="Documento Final Retiro Estudiantil"><button type="button" class="btn btn-success"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-filetype-pdf" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M14 4.5V14a2 2 0 0 1-2 2h-1v-1h1a1 1 0 0 0 1-1V4.5h-2A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v9H2V2a2 2 0 0 1 2-2h5.5L14 4.5ZM1.6 11.85H0v3.999h.791v-1.342h.803c.287 0 .531-.057.732-.173.203-.117.358-.275.463-.474a1.42 1.42 0 0 0 .161-.677c0-.25-.053-.476-.158-.677a1.176 1.176 0 0 0-.46-.477c-.2-.12-.443-.179-.732-.179Zm.545 1.333a.795.795 0 0 1-.085.38.574.574 0 0 1-.238.241.794.794 0 0 1-.375.082H.788V12.48h.66c.218 0 .389.06.512.181.123.122.185.296.185.522Zm1.217-1.333v3.999h1.46c.401 0 .734-.08.998-.237a1.45 1.45 0 0 0 .595-.689c.13-.3.196-.662.196-1.084 0-.42-.065-.778-.196-1.075a1.426 1.426 0 0 0-.589-.68c-.264-.156-.599-.234-1.005-.234H3.362Zm.791.645h.563c.248 0 .45.05.609.152a.89.89 0 0 1 .354.454c.079.201.118.452.118.753a2.3 2.3 0 0 1-.068.592 1.14 1.14 0 0 1-.196.422.8.8 0 0 1-.334.252 1.298 1.298 0 0 1-.483.082h-.563v-2.707Zm3.743 1.763v1.591h-.79V11.85h2.548v.653H7.896v1.117h1.606v.638H7.896Z"/>
</svg></button></a>
          <!--<a class="est-href" target="_blank" title="Documento Entrega Estudiante"><button type="button" class="btn btn-success"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-filetype-pdf" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M14 4.5V14a2 2 0 0 1-2 2h-1v-1h1a1 1 0 0 0 1-1V4.5h-2A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v9H2V2a2 2 0 0 1 2-2h5.5L14 4.5ZM1.6 11.85H0v3.999h.791v-1.342h.803c.287 0 .531-.057.732-.173.203-.117.358-.275.463-.474a1.42 1.42 0 0 0 .161-.677c0-.25-.053-.476-.158-.677a1.176 1.176 0 0 0-.46-.477c-.2-.12-.443-.179-.732-.179Zm.545 1.333a.795.795 0 0 1-.085.38.574.574 0 0 1-.238.241.794.794 0 0 1-.375.082H.788V12.48h.66c.218 0 .389.06.512.181.123.122.185.296.185.522Zm1.217-1.333v3.999h1.46c.401 0 .734-.08.998-.237a1.45 1.45 0 0 0 .595-.689c.13-.3.196-.662.196-1.084 0-.42-.065-.778-.196-1.075a1.426 1.426 0 0 0-.589-.68c-.264-.156-.599-.234-1.005-.234H3.362Zm.791.645h.563c.248 0 .45.05.609.152a.89.89 0 0 1 .354.454c.079.201.118.452.118.753a2.3 2.3 0 0 1-.068.592 1.14 1.14 0 0 1-.196.422.8.8 0 0 1-.334.252 1.298 1.298 0 0 1-.483.082h-.563v-2.707Zm3.743 1.763v1.591h-.79V11.85h2.548v.653H7.896v1.117h1.606v.638H7.896Z"/>
</svg></button></a>-->
        </td>
      </tr>
      <tr>
        <td colspan="4" class="mantenimientosEstadoRev" align="center">Aqui se muestran los estados </td>
      </tr>
    </template>

    <?!= include('JS');?>

    <script>
      function buscarRegistro(){
      
    const codigoEstudiante = document.getElementById("txt_codigoEstudiantil").value;
    google.script.run
    .withSuccessHandler(info =>{
        let tableBody = document.getElementById("manteniemientosTableBody");
        tableBody.innerHTML = "";
        if(info.length > 0){

          info.forEach( mantenimiento =>{
            //console.log('Dato 1:'+mantenimiento[18]+' Dato2: '+mantenimiento[35]+' Dato3: '+mantenimiento[37]);
            var urlconx='<?= pubUrl ?>';
            const template = document.getElementById("manteniemientosRow");
            const templateRow = template.content;
            let tr = templateRow.cloneNode(true);
            let colId = tr.querySelector(".mantenimientosId");
            let colFecha = tr.querySelector(".mantenimientosFecha");
            let colIdentificacion = tr.querySelector(".mantenimientosIdentifacion");
            let colCodigo = tr.querySelector(".mantenimientosCodigo");
            let colApenom = tr.querySelector(".mantenimientosApellidos");
            let colPrograma = tr.querySelector(".mantenimientosPrograma");
            let coladjunto = tr.querySelector(".adjunto-href");
            let coladfinal = tr.querySelector(".final-href");
            //let coladest = tr.querySelector(".est-href");
            let colEstado = tr.querySelector(".mantenimientosEstadoRev");

            //-------------------
            var cadena;
              if(mantenimiento[17]=='Completado') {
              cadena="<b>Estados de revisión:</b> <button type='button' class='btn btn-success'>PA</button>  " } else{
              cadena="<b>Estados de revisión:</b> <button type='button' class='btn btn-warning'>PA</button> "}
              if(mantenimiento[22]=='Completado') {
              cadena+="<button type='button' class='btn btn-success'>CC</button> " } else{
              cadena+="<button type='button' class='btn btn-warning'>CC</button> "}
              if(mantenimiento[25]=='Completado') {
              cadena+="<button type='button' class='btn btn-success'>AI</button> " } else{
              cadena+="<button type='button' class='btn btn-warning'>AI</button> "}                            
               if(mantenimiento[28]=='Completado') {
              cadena+="<button type='button' class='btn btn-success'>VA</button> " } else{
              cadena+="<button type='button' class='btn btn-warning'>VA</button> "} 
              if(mantenimiento[32]=='Completado') {
              cadena+="<button type='button' class='btn btn-success'>VF</button> " } else{
              cadena+="<button type='button' class='btn btn-warning'>VF</button> "}
              if(mantenimiento[34]=='Cierre') {
              cadena+="<button type='button' class='btn btn-success'>RCA</button>" } else{
              cadena+="<button type='button' class='btn btn-warning'>RCA</button>"}
            //-------------------

            colId.innerHTML  = '<h3>'+mantenimiento[0]+'</h3>';
            colFecha.textContent = mantenimiento[4];
            colIdentificacion.textContent = mantenimiento[7];
            colCodigo.textContent = mantenimiento[10];
            colApenom.textContent = mantenimiento[9];
            colPrograma.textContent = mantenimiento[3];
            coladjunto.href = mantenimiento[18];
            coladfinal.href = mantenimiento[35]===''?urlconx+'?p=10':mantenimiento[35];
            //coladest.href = mantenimiento[37];
            colEstado.innerHTML = cadena;

 
            tableBody.appendChild(tr);
          })
        }else {
          swal('Error en busqueda','No se encontro coincidencia con el codigo buscado','error');
        }
    })
    .buscarRegistro(codigoEstudiante.toString().toLocaleUpperCase());
   
  }//Fin buscar registro
    </script>
</body>

</html>