<!DOCTYPE html>
<html>

<head>
  <base target="_top">
  <?!= include('CSS');?>
</head>

<body class="my-0 vh-100 row justify-content-top align-items-top">
  <div class="container mt-0">
    <nav class="navbar navbar-dark bg-primary">
      <div> <h3 class="text-white">&nbsp;&nbsp;&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-bounding-box-circles" viewBox="0 0 16 16">
  <path d="M2 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zM0 2a2 2 0 0 1 3.937-.5h8.126A2 2 0 1 1 14.5 3.937v8.126a2 2 0 1 1-2.437 2.437H3.937A2 2 0 1 1 1.5 12.063V3.937A2 2 0 0 1 0 2zm2.5 1.937v8.126c.703.18 1.256.734 1.437 1.437h8.126a2.004 2.004 0 0 1 1.437-1.437V3.937A2.004 2.004 0 0 1 12.063 2.5H3.937A2.004 2.004 0 0 1 2.5 3.937zM14 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zM2 13a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm12 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/>
</svg>&nbsp;&nbsp;&nbsp;OfficeApp</h3></div> <h3 class="text-white align-rigth">UNIVERSIDAD UMARIANA&nbsp;&nbsp;&nbsp;</h3>
    </nav>
    <nav class="navbar navbar-expand-lg" style="background-color: #e3f2fd;">
      <div class="container-fluid">
        <a class="navbar-brand" href="<?= pubUrl ?>">Cerrar Sesión</a>
        <div class="vr"></div>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor03" aria-controls="navbarColor03" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
        <div class="collapse navbar-collapse" id="navbarColor03">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link active" href="<?= pubUrl ?>?p=1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-journal-plus" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 5.5a.5.5 0 0 1 .5.5v1.5H10a.5.5 0 0 1 0 1H8.5V10a.5.5 0 0 1-1 0V8.5H6a.5.5 0 0 1 0-1h1.5V6a.5.5 0 0 1 .5-.5z"/>
  <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"/>
  <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"/>
</svg> Nuevo Retiro</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="<?= pubUrl ?>?p=14"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-receipt-cutoff" viewBox="0 0 16 16">
  <path d="M3 4.5a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5zM11.5 4a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1zm0 2a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1zm0 2a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1zm0 2a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1zm0 2a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1z"/>
  <path d="M2.354.646a.5.5 0 0 0-.801.13l-.5 1A.5.5 0 0 0 1 2v13H.5a.5.5 0 0 0 0 1h15a.5.5 0 0 0 0-1H15V2a.5.5 0 0 0-.053-.224l-.5-1a.5.5 0 0 0-.8-.13L13 1.293l-.646-.647a.5.5 0 0 0-.708 0L11 1.293l-.646-.647a.5.5 0 0 0-.708 0L9 1.293 8.354.646a.5.5 0 0 0-.708 0L7 1.293 6.354.646a.5.5 0 0 0-.708 0L5 1.293 4.354.646a.5.5 0 0 0-.708 0L3 1.293 2.354.646zm-.217 1.198.51.51a.5.5 0 0 0 .707 0L4 1.707l.646.647a.5.5 0 0 0 .708 0L6 1.707l.646.647a.5.5 0 0 0 .708 0L8 1.707l.646.647a.5.5 0 0 0 .708 0L10 1.707l.646.647a.5.5 0 0 0 .708 0L12 1.707l.646.647a.5.5 0 0 0 .708 0l.509-.51.137.274V15H2V2.118l.137-.274z"/>
</svg> Calculo estudiantes pago parcial</a>
            </li>            
            <li class="nav-item">
              <a class="nav-link active" href="https://datastudio.google.com/s/kcaB6yweAUk"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bar-chart-line" viewBox="0 0 16 16">
  <path d="M11 2a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v12h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1v-3a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3h1V7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7h1V2zm1 12h2V2h-2v12zm-3 0V7H7v7h2zm-5 0v-3H2v3h2z"/>
</svg> DashBoard</a>
            </li>
          </ul>
          <form class="d-flex" role="search">
            <input class="form-control me-2" id="txt_codigoEstudiantil" type="search" placeholder="Buscar por código" aria-label="Search">
            <button class="btn btn-outline-primary" type="button" onclick="buscarRegistro()">Buscar</button>
          </form>
        </div>
      </div>
    </nav>
    <br/>
      <div class="container text-center">
        <div class="row">
          Convenciones
          <div class="col">
              <div class="badge bg-secondary text-wrap" style="width: 6rem;"><strong>PA</strong><hr class="my-1"> Programas Académicos</div>
            </div>
          <div class="col">
              <div class="badge bg-secondary text-wrap" style="width: 7rem;"><strong>CC</strong><hr class="my-1"> Crédito.Cartera</div>
          </div>
          <div class="col">
              <div class="badge bg-secondary text-wrap" style="width: 7rem;"><strong>AI</strong><hr class="my-1"> Acomp.Integral</div>
          </div>
          <div class="col">
              <div class="badge bg-secondary text-wrap" style="width: 6rem;"><strong>VA</strong><hr class="my-1"> Vic.Académica</div>
          </div>
          <div class="col">
              <div class="badge bg-secondary text-wrap" style="width: 6rem;"><strong>VF</strong><hr class="my-1"> Vic.Adm.Fin.</div>
          </div>
          <div class="col">
              <div class="badge bg-secondary text-wrap" style="width: 10rem;"><strong>RCA</strong><hr class="my-1"> Registro.Control.Acad.</div>
          </div>
        </div>
      </div>    
    <hr class="my-1">
    <table id="manteniemientosTable" class="table table-striped">
      <thead>
        <tr>
          <th>Id</th>
          <th>Fecha Solicitud Retiro</th>
          <th>Identificación</th>
          <th>Código Estudiantil</th>
          <th>Apellidos - Nombres</th>
          <th>Programa Académico</th>
          <th>Opciones</th>
        </tr>
      </thead>
      <tbody id="manteniemientosTableBody">
        <!-- aqui se insertara toda la informacion que la traigamos de los datos de busqueda-->
      </tbody>
    </table>
  </div>

  <template id="manteniemientosRow">
    <tr>
      <td class="mantenimientosId" rowspan="2" align="center" valign="middle"></td>
      <td class="mantenimientosFecha"></td>
      <td class="mantenimientosIdentifacion"></td>
      <td class="mantenimientosCodigo"></td>
      <td class="mantenimientosApellidos"></td>
      <td class="mantenimientosPrograma" rowspan="2" valign="middle"></td>
      <td class="mantenimientosBotones" rowspan="2" valign="middle">
        <!-- <a class="edit-href"
          title="Verificar Retiro"><button type="button" class="btn btn-primary editar-button">Revisar Retiro</button></a>-->
        <a class="adjunto-href" target="_blank" title="Documento soporte del retiro"><button type="button" class="btn btn-warning"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-filetype-doc" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M14 4.5V14a2 2 0 0 1-2 2v-1a1 1 0 0 0 1-1V4.5h-2A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v9H2V2a2 2 0 0 1 2-2h5.5L14 4.5Zm-7.839 9.166v.522c0 .256-.039.47-.117.641a.861.861 0 0 1-.322.387.877.877 0 0 1-.469.126.883.883 0 0 1-.471-.126.868.868 0 0 1-.32-.386 1.55 1.55 0 0 1-.117-.642v-.522c0-.257.04-.471.117-.641a.868.868 0 0 1 .32-.387.868.868 0 0 1 .471-.129c.176 0 .332.043.469.13a.861.861 0 0 1 .322.386c.078.17.117.384.117.641Zm.803.519v-.513c0-.377-.068-.7-.205-.972a1.46 1.46 0 0 0-.589-.63c-.254-.147-.56-.22-.917-.22-.355 0-.662.073-.92.22a1.441 1.441 0 0 0-.589.627c-.136.271-.205.596-.205.975v.513c0 .375.069.7.205.973.137.271.333.48.59.627.257.144.564.216.92.216.357 0 .662-.072.916-.216.256-.147.452-.356.59-.627.136-.274.204-.598.204-.973ZM0 11.926v4h1.459c.402 0 .735-.08.999-.238a1.45 1.45 0 0 0 .595-.689c.13-.3.196-.662.196-1.084 0-.42-.065-.778-.196-1.075a1.426 1.426 0 0 0-.59-.68c-.263-.156-.598-.234-1.004-.234H0Zm.791.645h.563c.248 0 .45.05.609.152a.89.89 0 0 1 .354.454c.079.201.118.452.118.753a2.3 2.3 0 0 1-.068.592 1.141 1.141 0 0 1-.196.422.8.8 0 0 1-.334.252 1.298 1.298 0 0 1-.483.082H.79V12.57Zm7.422.483a1.732 1.732 0 0 0-.103.633v.495c0 .246.034.455.103.627a.834.834 0 0 0 .298.393.845.845 0 0 0 .478.131.868.868 0 0 0 .401-.088.699.699 0 0 0 .273-.248.8.8 0 0 0 .117-.364h.765v.076a1.268 1.268 0 0 1-.226.674c-.137.194-.32.345-.55.454a1.81 1.81 0 0 1-.786.164c-.36 0-.664-.072-.914-.216a1.424 1.424 0 0 1-.571-.627c-.13-.272-.194-.597-.194-.976v-.498c0-.379.066-.705.197-.978.13-.274.321-.485.571-.633.252-.149.556-.223.911-.223.219 0 .421.032.607.097.187.062.35.153.489.272a1.326 1.326 0 0 1 .466.964v.073H9.78a.85.85 0 0 0-.12-.38.7.7 0 0 0-.273-.261.802.802 0 0 0-.398-.097.814.814 0 0 0-.475.138.868.868 0 0 0-.301.398Z"/>
</svg></button></a>
        <a class="final-href" target="_blank" title="Documento Final Retiro Estudiantil"><button type="button" class="btn btn-success"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-filetype-pdf" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M14 4.5V14a2 2 0 0 1-2 2h-1v-1h1a1 1 0 0 0 1-1V4.5h-2A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v9H2V2a2 2 0 0 1 2-2h5.5L14 4.5ZM1.6 11.85H0v3.999h.791v-1.342h.803c.287 0 .531-.057.732-.173.203-.117.358-.275.463-.474a1.42 1.42 0 0 0 .161-.677c0-.25-.053-.476-.158-.677a1.176 1.176 0 0 0-.46-.477c-.2-.12-.443-.179-.732-.179Zm.545 1.333a.795.795 0 0 1-.085.38.574.574 0 0 1-.238.241.794.794 0 0 1-.375.082H.788V12.48h.66c.218 0 .389.06.512.181.123.122.185.296.185.522Zm1.217-1.333v3.999h1.46c.401 0 .734-.08.998-.237a1.45 1.45 0 0 0 .595-.689c.13-.3.196-.662.196-1.084 0-.42-.065-.778-.196-1.075a1.426 1.426 0 0 0-.589-.68c-.264-.156-.599-.234-1.005-.234H3.362Zm.791.645h.563c.248 0 .45.05.609.152a.89.89 0 0 1 .354.454c.079.201.118.452.118.753a2.3 2.3 0 0 1-.068.592 1.14 1.14 0 0 1-.196.422.8.8 0 0 1-.334.252 1.298 1.298 0 0 1-.483.082h-.563v-2.707Zm3.743 1.763v1.591h-.79V11.85h2.548v.653H7.896v1.117h1.606v.638H7.896Z"/>
</svg></button></a>
      </td>
    </tr>
    <tr>
      <td colspan="4" class="mantenimientosEstadoRev" align="center">Aqui se muestran los estados </td>
    </tr>
  </template>

  <?!= include('JS');?>

  <script>
    function buscarRegistro(){
      
    const codigoEstudiante = document.getElementById("txt_codigoEstudiantil").value;
    google.script.run
    .withSuccessHandler(info =>{
        let tableBody = document.getElementById("manteniemientosTableBody");
        tableBody.innerHTML = "";
        if(info.length > 0){

          info.forEach( mantenimiento =>{
            var urlconx='<?= pubUrl ?>';
            const template = document.getElementById("manteniemientosRow");
            const templateRow = template.content;
            let tr = templateRow.cloneNode(true);
            let colId = tr.querySelector(".mantenimientosId");
            let colFecha = tr.querySelector(".mantenimientosFecha");
            let colIdentificacion = tr.querySelector(".mantenimientosIdentifacion");
            let colCodigo = tr.querySelector(".mantenimientosCodigo");
            let colApenom = tr.querySelector(".mantenimientosApellidos");
            let colPrograma = tr.querySelector(".mantenimientosPrograma");
            let coladjunto = tr.querySelector(".adjunto-href");
            let coladfinal = tr.querySelector(".final-href");
            let colEstado = tr.querySelector(".mantenimientosEstadoRev");

            //-------------------
            var cadena;
              if(mantenimiento[17]=='Completado') {
              cadena="<button type='button' class='btn btn-success'>PA</button> " } else{
              cadena="<button type='button' class='btn btn-warning'>PA</button> "}
              if(mantenimiento[22]=='Completado') {
              cadena+="<button type='button' class='btn btn-success'>CC</button> " } else{
              cadena+="<button type='button' class='btn btn-warning'>CC</button> "}
              if(mantenimiento[25]=='Completado') {
              cadena+="<button type='button' class='btn btn-success'>AI</button> " } else{
              cadena+="<button type='button' class='btn btn-warning'>AI</button> "}                            
               if(mantenimiento[28]=='Completado') {
              cadena+="<button type='button' class='btn btn-success'>VA</button> " } else{
              cadena+="<button type='button' class='btn btn-warning'>VA</button> "} 
              if(mantenimiento[32]=='Completado') {
              cadena+="<button type='button' class='btn btn-success'>VF</button> " } else{
              cadena+="<button type='button' class='btn btn-warning'>VF</button> "}
              if(mantenimiento[34]=='Cierre') {
              cadena+="<button type='button' class='btn btn-success'>RCA</button>" } else{
              cadena+="<button type='button' class='btn btn-warning'>RCA</button>"}
            //-------------------

            colId.innerHTML  = '<h3>'+mantenimiento[0]+'<h3>';
            colFecha.textContent = mantenimiento[4];
            colIdentificacion.textContent = mantenimiento[7];
            colCodigo.textContent = mantenimiento[10];
            colApenom.textContent = mantenimiento[9];
            colPrograma.textContent = mantenimiento[3];
            coladjunto.href = mantenimiento[18];
            coladfinal.href = mantenimiento[35]===''?urlconx+'?p=10':mantenimiento[35];
            colEstado.innerHTML = cadena;

 
            tableBody.appendChild(tr);
          })
        }else {
          swal('Error en busqueda','No se encontro coincidencia con el codigo buscado','error');
        }
    })
    .buscarRegistro(codigoEstudiante.toString().toLocaleUpperCase()));
   
  }//Fin buscar registro
  </script>
</body>

</html>