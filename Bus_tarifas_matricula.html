<!DOCTYPE html>
<html>

<head>
  <base target="_top">
  <?!= include('CSS');?>
</head>

<body class="my-0 vh-100 row justify-content-top align-items-top">
  <div class="container mt-0">
    <nav class="navbar navbar-dark bg-primary">
      <div>
        <h3 class="text-white">&nbsp;&nbsp;&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"
            fill="currentColor" class="bi bi-bounding-box-circles" viewBox="0 0 16 16">
            <path
              d="M2 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zM0 2a2 2 0 0 1 3.937-.5h8.126A2 2 0 1 1 14.5 3.937v8.126a2 2 0 1 1-2.437 2.437H3.937A2 2 0 1 1 1.5 12.063V3.937A2 2 0 0 1 0 2zm2.5 1.937v8.126c.703.18 1.256.734 1.437 1.437h8.126a2.004 2.004 0 0 1 1.437-1.437V3.937A2.004 2.004 0 0 1 12.063 2.5H3.937A2.004 2.004 0 0 1 2.5 3.937zM14 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zM2 13a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm12 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2z" />
          </svg>&nbsp;&nbsp;&nbsp;OFFICE-APP</h3>
      </div>
      <h3 class="text-white align-rigth">UNIVERSIDAD UMARIANA&nbsp;&nbsp;&nbsp;</h3>
    </nav>
    <nav class="navbar navbar-expand-lg" style="background-color: #e3f2fd;">
      <div class="collapse navbar-collapse" id="navbarColor03">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" href="<?= pubUrl ?>?p=12"><svg xmlns="http://www.w3.org/2000/svg" width="16"
                height="16" fill="currentColor" class="bi bi-telephone-plus-fill" viewBox="0 0 16 16">
                <path fill-rule="evenodd"
                  d="M1.885.511a1.745 1.745 0 0 1 2.61.163L6.29 2.98c.329.423.445.974.315 1.494l-.547 2.19a.678.678 0 0 0 .178.643l2.457 2.457a.678.678 0 0 0 .644.178l2.189-.547a1.745 1.745 0 0 1 1.494.315l2.306 1.794c.829.645.905 1.87.163 2.611l-1.034 1.034c-.74.74-1.846 1.065-2.877.702a18.634 18.634 0 0 1-7.01-4.42 18.634 18.634 0 0 1-4.42-7.009c-.362-1.03-.037-2.137.703-2.877L1.885.511zM12.5 1a.5.5 0 0 1 .5.5V3h1.5a.5.5 0 0 1 0 1H13v1.5a.5.5 0 0 1-1 0V4h-1.5a.5.5 0 0 1 0-1H12V1.5a.5.5 0 0 1 .5-.5z" />
              </svg> Guía Telefónica</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active"
              href="<?= pubUrl ?>?p=13"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAABo0lEQVRIic3VzWoUQRAH8J8reBMUMevBj4cwkCiC0WfwlJO3gA+xevUWiAriwYNPIOIKihcFP5K9CJ4Dkt2LoJDkuMp4mBps2+ldRwJaUMx09b8+urqriv+MloMPhHroJ+vzmAYvJvJ+YDvTPVQYYoBxrKv4H8Rehbt/4+B9YnAev+tq/Az2OjjYw+l5RnvqtIyw38F46mSEOwp3cqqg+Bz3sZPIvuIFPhR0FkqnGGbA9ZAfw0l8Cfl1HMbrFuPDWWm6mYEv4yLexv5jbEYKbhWiH5SML2KSgVcj8rXAbOECLuFbwcHYr3VCKE1bwNu4gnNxukc4jk8F4w1PsZQ6WC44yCM7gYeRhrNYiSDmOmhSNG4BV/iOq4HZDPwNdZtYzbA76rbSSvklN3w79l/hSfy/iZOvZNjiJfP7M63UxXME1/ysgT6Ohs5Ghn9aMl4qtI/qovqcyCZ4gJcFndZC66nLfKRbH2p4N3Q3cGhWmqgbVxcnu/6g2eV0IO161iQaxbcZOJNkrxk4z2K91TX6xnl6WenITN/5wpxAO9GSlgr9p/QDn0PzvQrrNU0AAAAASUVORK5CYII="> Tarifas Matrícula 1-2023</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active"
              href="<?= pubUrl ?>?p=14"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAABo0lEQVRIic3VzWoUQRAH8J8reBMUMevBj4cwkCiC0WfwlJO3gA+xevUWiAriwYNPIOIKihcFP5K9CJ4Dkt2LoJDkuMp4mBps2+ldRwJaUMx09b8+urqriv+MloMPhHroJ+vzmAYvJvJ+YDvTPVQYYoBxrKv4H8Rehbt/4+B9YnAev+tq/Az2OjjYw+l5RnvqtIyw38F46mSEOwp3cqqg+Bz3sZPIvuIFPhR0FkqnGGbA9ZAfw0l8Cfl1HMbrFuPDWWm6mYEv4yLexv5jbEYKbhWiH5SML2KSgVcj8rXAbOECLuFbwcHYr3VCKE1bwNu4gnNxukc4jk8F4w1PsZQ6WC44yCM7gYeRhrNYiSDmOmhSNG4BV/iOq4HZDPwNdZtYzbA76rbSSvklN3w79l/hSfy/iZOvZNjiJfP7M63UxXME1/ysgT6Ohs5Ghn9aMl4qtI/qovqcyCZ4gJcFndZC66nLfKRbH2p4N3Q3cGhWmqgbVxcnu/6g2eV0IO161iQaxbcZOJNkrxk4z2K91TX6xnl6WenITN/5wpxAO9GSlgr9p/QDn0PzvQrrNU0AAAAASUVORK5CYII="> Generar Recibo Pago Anticipado</a>
          </li>
        </ul>
        <!-- Acuertos botonera -->
        <div class="btn-group">
          <button type="button" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-journal-arrow-down" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 5a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 1 1 .708-.708L7.5 9.293V5.5A.5.5 0 0 1 8 5z"/>
  <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"/>
  <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"/>
</svg>  Contabilidad - SEVEN
  </button> &nbsp;&nbsp;
          <?!= include('doc_contable');?>
        </div>
        <!-- Fin botonera -->            
        <!-- Example single danger button -->
        <div class="btn-group">
          <button type="button" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-layout-text-window" viewBox="0 0 16 16">
  <path d="M3 6.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0 3a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm.5 2.5a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1h-5z"/>
  <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm12 1a1 1 0 0 1 1 1v1H1V2a1 1 0 0 1 1-1h12zm1 3v10a1 1 0 0 1-1 1h-2V4h3zm-4 0v11H2a1 1 0 0 1-1-1V4h10z"/>
</svg>  Acuerdos UMARIANA
  </button> &nbsp;&nbsp;
          <?!= include('doc_acuerdos');?>

        </div>
        <!-- Fin generacion boton -->
        <div class="vr"></div>
        <div class="d-flex">&nbsp;&nbsp;
          <a class="navbar-brand" href="<?= pubUrl ?>"><strong>Cerrar Sesión</strong></a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor03" aria-controls="navbarColor03" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
        </div>
      </div>
    </nav>
    <div class="container mt-5">
      <h5 class="text-primary">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAACyElEQVRoge2ZS2gTURSGv2hbSaiPSluy0Co+ChUVdSMFcePGTRe6FC0oio+dui2udF8XSkFQKrhx1Y0rF0IFCz5QqJRulBYsCFkYH1RbrXFxz5DJNHcy986diYH5YEgy9z/nnj+ZnDu5gYyMWOQCr3uBzmYUYsB3oFRv4BZQaYHjL3DTK9r7BPLi7BcwZffGpMYgsA7YAPz0Tnaj3M00qSgTZlC1dgOsaW4t8UnTwGFgl+ukaRnoA54DD10nTsvAMNAOvHSd2IWB3cD5kFw5lAGAcd+8FyTWCbZdqAeYl9i9Gs0RGX/nO7dfzs1LDhNqupCHjYE24JnETbB6Vfe4J5qrvnM5ialIjjaDeZ0ZuC0xs8BGjSYPfAF+A8XAWCfwXnKMGszrxMBp0X8D9kTQTWjG+1EGK8C5iHPHNrAPWARWgKEG2qeS90SIZkhyLUruRsQ2cFm0H4FCiK5PCisBHSG6guSqSO5GxDbQjlqUKsCjEN0I0a7vB6KbQt2kNcLJd6AILEjMNY1mVsYPhuS5LprPwJaIczvrQoPAEvAHOB4Y83r/dEj8MVR3WgaOGszrzABUvw+lQMJ6vd9Pj8REve79ODUAcBcoA1vldQH4inpnezUxRVT7vGMxn3MDQRr1/rgk/oPmlDyOh6ockYSBOeAF8CSB3KswuYmKypUEcmoJGugAdqRZgAU1q3rQwE7gQ3q1xCfblUiYJeBtmOB/N3ADOAS80QmS6EIuOYla0Qd0Au937CbU0t5KdAFl7xIqA6+bWIwpr1A11+wkbAbOYr7NkTYl4D6td8XUR7eXY8MlYHtE7Rww5nBuJ0wS/V+WSVeT2rbR9cBF4ADVexNtq6vDAPBYni+jth3HgB+W9RiRp7qj5vKYltyJM5xA8d5xxrQYm1sJZ1videg3DbAxsGARE5VPpgG2bXQbsNYyVscK6v+CjIw0+QeImwiTTxUMLQAAAABJRU5ErkJggg==">
        Buscar Tarifas de Matrícula por Programa
      </h5>
      <br/>
      <div class="row d-flex justify-content-center mb-3">
        <div class="col">
          <input type="text" class="form-control" id="input-search" placeholder="Digíte el programa a filtrar" aria-label="Oficina a buscar">
        </div>
        <br>
      </div>

      <table id="manteniemientosTable" class="table table-striped">
        <thead>
          <tr>
            <th>Periodo</th>
            <th>Programa</th>
            <th>Semestre</th>
            <th>Créditos Académicos</th>
            <th>Valor Crédito</th>
            <th>Total a Pagar</th>
            <th>(5%) Hasta 15 de Dic.</th>
            <th>(3%) Hasta 30 de Dic.</th>
            <th>(2%) Hasta 12 de Ene.</th>
            <th>(5%) Extraordinaria.</th>
          </tr>
        </thead>
        <tbody id="manteniemientosTableBody">
          <!-- aqui se insertara los resultados de busqueda-->
        </tbody>
      </table>
    </div>
  </div>

  <template id="manteniemientosRow">
    <tr>
      <td class="mantenimientosPeriodo"></td>
      <td class="mantenimientosPrograma"></td>
      <td class="mantenimientosSemestre" align="center"></td>
      <td class="mantenimientosCredito" align="center"></td>
      <td class="mantenimientosValorCredito"></td>
      <td class="mantenimientosTotalpagar"></td>
      <td class="mantenimientos5" align="center"></td>
      <td class="mantenimientos3" align="center"></td>
      <td class="mantenimientos2" align="center"></td>
      <td class="mantenimientos_5" align="center"></td>      
    </tr>
  </template>

  <?!= include('JS');?>

  <script>
    window.addEventListener("load", lookforDataTable);
    document.getElementById("input-search").addEventListener( "input", onInputChange );
    
    function lookforDataTable(){
      google.script.run
      .withSuccessHandler( mantenimientos =>{
        let tableBody = document.getElementById("manteniemientosTableBody");
        var templateBox = document.getElementById("manteniemientosRow");
        var template = templateBox.content;
        mantenimientos.forEach(mantenimiento=>{

            let tr = template.cloneNode(true);
            let colPeriodo= tr.querySelector(".mantenimientosPeriodo");
            let colPrograma = tr.querySelector(".mantenimientosPrograma");
            let colSemestre = tr.querySelector(".mantenimientosSemestre");
            let colCredito = tr.querySelector(".mantenimientosCredito");            
            let colValorCredito= tr.querySelector(".mantenimientosValorCredito");
            let colTotalpagar= tr.querySelector(".mantenimientosTotalpagar");
            let colValor5= tr.querySelector(".mantenimientos5");
            let colValor3= tr.querySelector(".mantenimientos3");     
            let colValor2= tr.querySelector(".mantenimientos2");     
            let colValor_5= tr.querySelector(".mantenimientos_5");                                        

            colPeriodo.textContent = mantenimiento[1];
            colPrograma.textContent = mantenimiento[2];
            colSemestre.textContent  = mantenimiento[3];
            colCredito.textContent  = mantenimiento[4];            
            colValorCredito.textContent = formatterPeso.format(mantenimiento[5]);
            colTotalpagar.textContent = formatterPeso.format(mantenimiento[6]);
            colValor5.textContent = formatterPeso.format(parseInt(mantenimiento[7]));
            colValor3.textContent = formatterPeso.format(mantenimiento[8]);
            colValor2.textContent = formatterPeso.format(mantenimiento[9]);
            colValor_5.textContent = formatterPeso.format(mantenimiento[10]);                                    
          tableBody.appendChild( tr );

        })
      })
      .getDataMat();
    }

    function onInputChange(){
      let inputText = remove_accents(document.getElementById("input-search").value.toString().toLowerCase());
       //console.log('Ver:'+inputText);
      let tableBody = document.getElementById("manteniemientosTableBody");
      let tableBodyRows = tableBody.getElementsByTagName("tr");
      //console.log('ver1:'+tableBodyRows.length);
      for( let i = 0; i < tableBodyRows.length; i++ ){
        //console.log(tableBodyRows[i].cells[3].textContent);
        let textForQuery = remove_accents(tableBodyRows[i].cells[1].textContent.toString().toLowerCase());
       // console.log('Busqueda:'+inputText);
        if( textForQuery.indexOf(inputText) === -1 ){
          tableBodyRows[i].style.visibility = "collapse";
        }else{
          tableBodyRows[i].style.visibility = "";
        }
      }

    }
    function remove_accents(strAccents) {
        var strAccents = strAccents.split('');
        var strAccentsOut = new Array();
        var strAccentsLen = strAccents.length;
        var accents =    "ÀÁÂÃÄÅàáâãäåÒÓÔÕÕÖØòóôõöøÈÉÊËèéêëÇçðÐÌÍÎÏìíîïÙÚÛÜùúûüÑñŠšŸÿýŽž";
        var accentsOut = "AAAAAAaaaaaaOOOOOOOooooooEEEEeeeeCcdDIIIIiiiiUUUUuuuuNnSsYyyZz";
        for (var y = 0; y < strAccentsLen; y++) {
            if (accents.indexOf(strAccents[y]) != -1) {
                strAccentsOut[y] = accentsOut.substr(accents.indexOf(strAccents[y]), 1);
            } else
                strAccentsOut[y] = strAccents[y];
        }
        strAccentsOut = strAccentsOut.join('');

        return strAccentsOut;
    }

  function getNumbersInString(string) {
  var tmp = string.split("");
  var map = tmp.map(function(current) {
    if (!isNaN(parseInt(current))) {
      return current;
    }
  });

  var numbers = map.filter(function(value) {
    return value != undefined;
  });

  return numbers.join("");
}

    const formatterPeso = new Intl.NumberFormat('es-CO', {
       style: 'currency',
       currency: 'COP',
       minimumFractionDigits: 0
     })
       
  </script>
</body>

</html>